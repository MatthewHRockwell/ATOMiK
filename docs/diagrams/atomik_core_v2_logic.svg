<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 600" font-family="Monaco, Consolas, monospace">
  <!-- Background -->
  <rect width="900" height="600" fill="#fafafa"/>
  
  <!-- Title -->
  <text x="450" y="35" text-anchor="middle" font-size="20" font-weight="bold" fill="#1e293b">ATOMiK Core v2 - Logic Gate Diagram</text>
  <text x="450" y="55" text-anchor="middle" font-size="12" fill="#64748b">64-bit Delta Accumulator with State Reconstruction</text>
  
  <!-- Main container -->
  <rect x="50" y="80" width="800" height="440" fill="none" stroke="#cbd5e1" stroke-width="2" stroke-dasharray="5,5" rx="8"/>
  <text x="70" y="100" font-size="11" fill="#64748b">ATOMiK Core v2</text>
  
  <!-- ==================== INPUT SECTION ==================== -->
  
  <!-- data_in input -->
  <text x="30" y="200" text-anchor="end" font-size="11" fill="#059669" font-weight="bold">data_in[63:0]</text>
  <line x1="35" y1="195" x2="100" y2="195" stroke="#059669" stroke-width="3"/>
  <polygon points="95,190 105,195 95,200" fill="#059669"/>
  
  <!-- operation input -->
  <text x="30" y="320" text-anchor="end" font-size="11" fill="#7c3aed" font-weight="bold">operation[1:0]</text>
  <line x1="35" y1="315" x2="100" y2="315" stroke="#7c3aed" stroke-width="2"/>
  <polygon points="95,310 105,315 95,320" fill="#7c3aed"/>
  
  <!-- Clock input -->
  <text x="30" y="420" text-anchor="end" font-size="11" fill="#0891b2" font-weight="bold">clk</text>
  <line x1="35" y1="415" x2="100" y2="415" stroke="#0891b2" stroke-width="2"/>
  
  <!-- ==================== CONTROL LOGIC ==================== -->
  
  <!-- Control Decoder Box -->
  <rect x="110" y="280" width="100" height="80" fill="#f3e8ff" stroke="#7c3aed" stroke-width="2" rx="4"/>
  <text x="160" y="300" text-anchor="middle" font-size="10" fill="#7c3aed" font-weight="bold">CONTROL</text>
  <text x="160" y="315" text-anchor="middle" font-size="10" fill="#7c3aed" font-weight="bold">DECODER</text>
  <text x="160" y="335" text-anchor="middle" font-size="9" fill="#6b7280">00: NOP</text>
  <text x="160" y="347" text-anchor="middle" font-size="9" fill="#6b7280">01: LOAD</text>
  <text x="160" y="359" text-anchor="middle" font-size="9" fill="#6b7280">10: ACCUM</text>
  
  <!-- Control signals out -->
  <line x1="210" y1="300" x2="240" y2="300" stroke="#7c3aed" stroke-width="1.5"/>
  <text x="245" y="304" font-size="9" fill="#7c3aed">load_en</text>
  <line x1="210" y1="330" x2="240" y2="330" stroke="#7c3aed" stroke-width="1.5"/>
  <text x="245" y="334" font-size="9" fill="#7c3aed">acc_en</text>
  
  <!-- ==================== INITIAL STATE REGISTER ==================== -->
  
  <!-- Initial State Register -->
  <rect x="300" y="120" width="140" height="50" fill="#dbeafe" stroke="#2563eb" stroke-width="2" rx="4"/>
  <text x="370" y="142" text-anchor="middle" font-size="11" fill="#1e40af" font-weight="bold">initial_state</text>
  <text x="370" y="158" text-anchor="middle" font-size="10" fill="#3b82f6">[63:0] Register</text>
  
  <!-- Clock triangle for initial_state -->
  <path d="M300,160 L310,150 L300,140" fill="none" stroke="#0891b2" stroke-width="1.5"/>
  
  <!-- Load MUX for initial_state -->
  <path d="M270,130 L290,140 L290,160 L270,170 Z" fill="#fef3c7" stroke="#d97706" stroke-width="1.5"/>
  <text x="280" y="153" text-anchor="middle" font-size="8" fill="#92400e">M</text>
  
  <!-- data_in to initial_state MUX -->
  <line x1="100" y1="195" x2="240" y2="195" stroke="#059669" stroke-width="2"/>
  <line x1="240" y1="195" x2="240" y2="140" stroke="#059669" stroke-width="2"/>
  <line x1="240" y1="140" x2="270" y2="140" stroke="#059669" stroke-width="2"/>
  
  <!-- Feedback to MUX -->
  <line x1="440" y1="145" x2="460" y2="145" stroke="#2563eb" stroke-width="2"/>
  <line x1="460" y1="145" x2="460" y2="100" stroke="#2563eb" stroke-width="2"/>
  <line x1="460" y1="100" x2="250" y2="100" stroke="#2563eb" stroke-width="2"/>
  <line x1="250" y1="100" x2="250" y2="160" stroke="#2563eb" stroke-width="2"/>
  <line x1="250" y1="160" x2="270" y2="160" stroke="#2563eb" stroke-width="2"/>
  
  <!-- load_en to MUX -->
  <line x1="280" y1="300" x2="280" y2="170" stroke="#7c3aed" stroke-width="1" stroke-dasharray="3,3"/>
  
  <!-- ==================== DELTA ACCUMULATOR ==================== -->
  
  <!-- Accumulator Register -->
  <rect x="300" y="230" width="140" height="50" fill="#dcfce7" stroke="#16a34a" stroke-width="2" rx="4"/>
  <text x="370" y="252" text-anchor="middle" font-size="11" fill="#166534" font-weight="bold">accumulator</text>
  <text x="370" y="268" text-anchor="middle" font-size="10" fill="#22c55e">[63:0] Register</text>
  
  <!-- Clock triangle for accumulator -->
  <path d="M300,270 L310,260 L300,250" fill="none" stroke="#0891b2" stroke-width="1.5"/>
  
  <!-- XOR Gate for accumulation -->
  <g transform="translate(230, 270)">
    <path d="M0,0 C15,-10 15,-30 0,-40 L30,-40 C45,-30 45,-10 30,0 Z" fill="#fef9c3" stroke="#ca8a04" stroke-width="2"/>
    <path d="M-5,0 C10,-10 10,-30 -5,-40" fill="none" stroke="#ca8a04" stroke-width="2"/>
    <text x="15" y="-16" text-anchor="middle" font-size="12" fill="#854d0e" font-weight="bold">⊕</text>
  </g>
  
  <!-- data_in to XOR -->
  <line x1="150" y1="195" x2="150" y2="240" stroke="#059669" stroke-width="2"/>
  <line x1="150" y1="240" x2="225" y2="240" stroke="#059669" stroke-width="2"/>
  
  <!-- Accumulator feedback to XOR -->
  <line x1="440" y1="255" x2="480" y2="255" stroke="#16a34a" stroke-width="2"/>
  <line x1="480" y1="255" x2="480" y2="210" stroke="#16a34a" stroke-width="2"/>
  <line x1="480" y1="210" x2="200" y2="210" stroke="#16a34a" stroke-width="2"/>
  <line x1="200" y1="210" x2="200" y2="260" stroke="#16a34a" stroke-width="2"/>
  <line x1="200" y1="260" x2="225" y2="260" stroke="#16a34a" stroke-width="2"/>
  
  <!-- XOR output to accumulator -->
  <line x1="265" y1="250" x2="300" y2="250" stroke="#ca8a04" stroke-width="2"/>
  
  <!-- acc_en to accumulator -->
  <line x1="290" y1="330" x2="290" y2="280" stroke="#7c3aed" stroke-width="1" stroke-dasharray="3,3"/>
  <line x1="290" y1="280" x2="300" y2="280" stroke="#7c3aed" stroke-width="1" stroke-dasharray="3,3"/>
  
  <!-- ==================== STATE RECONSTRUCTOR ==================== -->
  
  <!-- Reconstructor Box -->
  <rect x="520" y="160" width="180" height="120" fill="#fff7ed" stroke="#ea580c" stroke-width="2" rx="4"/>
  <text x="610" y="180" text-anchor="middle" font-size="11" fill="#c2410c" font-weight="bold">STATE RECONSTRUCTOR</text>
  <text x="610" y="195" text-anchor="middle" font-size="9" fill="#9a3412">(Combinational - 0 cycles)</text>
  
  <!-- XOR Gate for reconstruction -->
  <g transform="translate(575, 250)">
    <path d="M0,0 C15,-10 15,-30 0,-40 L30,-40 C45,-30 45,-10 30,0 Z" fill="#fef9c3" stroke="#ca8a04" stroke-width="2"/>
    <path d="M-5,0 C10,-10 10,-30 -5,-40" fill="none" stroke="#ca8a04" stroke-width="2"/>
    <text x="15" y="-16" text-anchor="middle" font-size="12" fill="#854d0e" font-weight="bold">⊕</text>
  </g>
  
  <!-- initial_state to reconstructor -->
  <line x1="440" y1="145" x2="500" y2="145" stroke="#2563eb" stroke-width="2"/>
  <line x1="500" y1="145" x2="500" y2="220" stroke="#2563eb" stroke-width="2"/>
  <line x1="500" y1="220" x2="570" y2="220" stroke="#2563eb" stroke-width="2"/>
  
  <!-- accumulator to reconstructor -->
  <line x1="440" y1="255" x2="510" y2="255" stroke="#16a34a" stroke-width="2"/>
  <line x1="510" y1="255" x2="510" y2="240" stroke="#16a34a" stroke-width="2"/>
  <line x1="510" y1="240" x2="570" y2="240" stroke="#16a34a" stroke-width="2"/>
  
  <!-- XOR output = current_state -->
  <line x1="610" y1="230" x2="680" y2="230" stroke="#ea580c" stroke-width="2"/>
  <text x="640" y="218" font-size="9" fill="#c2410c">current_state</text>
  
  <!-- ==================== OUTPUT REGISTER ==================== -->
  
  <!-- Output Register -->
  <rect x="720" y="205" width="100" height="50" fill="#fce7f3" stroke="#db2777" stroke-width="2" rx="4"/>
  <text x="770" y="227" text-anchor="middle" font-size="11" fill="#9d174d" font-weight="bold">data_out</text>
  <text x="770" y="243" text-anchor="middle" font-size="10" fill="#ec4899">[63:0]</text>
  
  <!-- Clock triangle for output -->
  <path d="M720,245 L730,235 L720,225" fill="none" stroke="#0891b2" stroke-width="1.5"/>
  
  <!-- reconstructor to output -->
  <line x1="680" y1="230" x2="720" y2="230" stroke="#ea580c" stroke-width="2"/>
  
  <!-- Output arrow -->
  <line x1="820" y1="230" x2="870" y2="230" stroke="#db2777" stroke-width="3"/>
  <polygon points="865,225 875,230 865,235" fill="#db2777"/>
  
  <!-- ==================== CLOCK DISTRIBUTION ==================== -->
  
  <!-- Clock line -->
  <line x1="100" y1="415" x2="770" y2="415" stroke="#0891b2" stroke-width="1.5" stroke-dasharray="5,3"/>
  <line x1="305" y1="415" x2="305" y2="170" stroke="#0891b2" stroke-width="1" stroke-dasharray="3,2"/>
  <line x1="305" y1="415" x2="305" y2="280" stroke="#0891b2" stroke-width="1" stroke-dasharray="3,2"/>
  <line x1="725" y1="415" x2="725" y2="255" stroke="#0891b2" stroke-width="1" stroke-dasharray="3,2"/>
  
  <!-- ==================== ANNOTATIONS ==================== -->
  
  <!-- Key equation -->
  <rect x="520" y="290" width="180" height="35" fill="#f0fdf4" stroke="#16a34a" stroke-width="1" rx="4"/>
  <text x="610" y="312" text-anchor="middle" font-size="11" fill="#166534" font-weight="bold">current = initial ⊕ acc</text>
  
  <!-- XOR advantage annotation -->
  <rect x="100" y="380" width="180" height="55" fill="#fefce8" stroke="#ca8a04" stroke-width="1" rx="4"/>
  <text x="190" y="398" text-anchor="middle" font-size="10" fill="#854d0e" font-weight="bold">Why XOR = Single Cycle</text>
  <text x="190" y="413" text-anchor="middle" font-size="9" fill="#a16207">• No carry propagation</text>
  <text x="190" y="426" text-anchor="middle" font-size="9" fill="#a16207">• All 64 bits compute in parallel</text>
  
  <!-- Timing annotation -->
  <rect x="300" y="380" width="180" height="55" fill="#eff6ff" stroke="#3b82f6" stroke-width="1" rx="4"/>
  <text x="390" y="398" text-anchor="middle" font-size="10" fill="#1e40af" font-weight="bold">Operation Latency</text>
  <text x="390" y="413" text-anchor="middle" font-size="9" fill="#3b82f6">LOAD: 1 cycle | ACCUM: 1 cycle</text>
  <text x="390" y="426" text-anchor="middle" font-size="9" fill="#3b82f6">READ: 1 cycle (no penalty)</text>
  
  <!-- Parallelism annotation -->
  <rect x="500" y="380" width="180" height="55" fill="#fdf4ff" stroke="#a855f7" stroke-width="1" rx="4"/>
  <text x="590" y="398" text-anchor="middle" font-size="10" fill="#7e22ce" font-weight="bold">Parallelism Property</text>
  <text x="590" y="413" text-anchor="middle" font-size="9" fill="#9333ea">δ₁ ⊕ δ₂ = δ₂ ⊕ δ₁</text>
  <text x="590" y="426" text-anchor="middle" font-size="9" fill="#9333ea">Lock-free accumulation</text>
  
  <!-- Legend -->
  <rect x="100" y="450" width="350" height="60" fill="#f8fafc" stroke="#94a3b8" stroke-width="1" rx="4"/>
  <text x="115" y="468" font-size="10" fill="#475569" font-weight="bold">Legend:</text>
  <line x1="115" y1="483" x2="145" y2="483" stroke="#059669" stroke-width="3"/>
  <text x="150" y="487" font-size="9" fill="#475569">Data Input</text>
  <line x1="115" y1="498" x2="145" y2="498" stroke="#2563eb" stroke-width="2"/>
  <text x="150" y="502" font-size="9" fill="#475569">Initial State</text>
  <line x1="230" y1="483" x2="260" y2="483" stroke="#16a34a" stroke-width="2"/>
  <text x="265" y="487" font-size="9" fill="#475569">Accumulator</text>
  <line x1="230" y1="498" x2="260" y2="498" stroke="#7c3aed" stroke-width="1.5" stroke-dasharray="3,3"/>
  <text x="265" y="502" font-size="9" fill="#475569">Control</text>
  <line x1="345" y1="483" x2="375" y2="483" stroke="#0891b2" stroke-width="1.5" stroke-dasharray="5,3"/>
  <text x="380" y="487" font-size="9" fill="#475569">Clock</text>
  <g transform="translate(345, 505)">
    <path d="M0,0 C8,-5 8,-15 0,-20 L15,-20 C23,-15 23,-5 15,0 Z" fill="#fef9c3" stroke="#ca8a04" stroke-width="1.5"/>
    <text x="7" y="-7" text-anchor="middle" font-size="8" fill="#854d0e">⊕</text>
  </g>
  <text x="380" y="502" font-size="9" fill="#475569">XOR Gate</text>
  
</svg>
