<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 860 540" font-family="'Segoe UI', 'Helvetica Neue', Arial, sans-serif">
  <defs>
    <linearGradient id="coordBg" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#334155"/>
      <stop offset="100%" stop-color="#1e293b"/>
    </linearGradient>
    <linearGradient id="specBg" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#818cf8"/>
      <stop offset="100%" stop-color="#6366f1"/>
    </linearGradient>
    <linearGradient id="consBg" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#fbbf24"/>
      <stop offset="100%" stop-color="#f59e0b"/>
    </linearGradient>
    <linearGradient id="regBg" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#4ade80"/>
      <stop offset="100%" stop-color="#22c55e"/>
    </linearGradient>
    <linearGradient id="resBg" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#06b6d4"/>
      <stop offset="100%" stop-color="#0891b2"/>
    </linearGradient>
    <filter id="shadow" x="-4%" y="-4%" width="108%" height="116%">
      <feDropShadow dx="0" dy="2" stdDeviation="4" flood-color="#000" flood-opacity="0.10"/>
    </filter>
    <filter id="shadowSm" x="-4%" y="-4%" width="108%" height="116%">
      <feDropShadow dx="0" dy="1" stdDeviation="2" flood-color="#000" flood-opacity="0.08"/>
    </filter>
    <marker id="arrowD" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <polygon points="0,0 8,3 0,6" fill="#94a3b8"/>
    </marker>
    <marker id="arrowUp" markerWidth="8" markerHeight="6" refX="0" refY="3" orient="auto">
      <polygon points="8,0 0,3 8,6" fill="#94a3b8"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="860" height="540" fill="#f8fafc" rx="6"/>

  <!-- Title -->
  <text x="430" y="30" text-anchor="middle" font-size="18" fill="#0f172a" font-weight="700">Phase 5: Multi-Agent Coordination Model</text>
  <text x="430" y="48" text-anchor="middle" font-size="11" fill="#64748b">Coordinator dispatches to specialists, consensus resolves conflicts</text>

  <!-- ============ AGENT REGISTRY (top left) ============ -->
  <g filter="url(#shadowSm)">
    <rect x="40" y="70" width="180" height="80" rx="8" fill="url(#regBg)"/>
  </g>
  <text x="130" y="93" text-anchor="middle" font-size="11" fill="#14532d" font-weight="500" letter-spacing="1">AGENT REGISTRY</text>
  <text x="130" y="112" text-anchor="middle" font-size="10" fill="#166534">Capability matching</text>
  <text x="130" y="126" text-anchor="middle" font-size="10" fill="#166534">Health monitoring</text>
  <text x="130" y="140" text-anchor="middle" font-size="10" fill="#166534">Dynamic registration</text>

  <!-- Arrow from registry to coordinator -->
  <line x1="220" y1="110" x2="290" y2="110" stroke="#94a3b8" stroke-width="1.5" marker-end="url(#arrowD)"/>

  <!-- ============ COORDINATOR AGENT (center top) ============ -->
  <g filter="url(#shadow)">
    <rect x="300" y="70" width="260" height="80" rx="10" fill="url(#coordBg)"/>
  </g>
  <text x="430" y="95" text-anchor="middle" font-size="14" fill="#f1f5f9" font-weight="700">Coordinator Agent</text>
  <text x="430" y="114" text-anchor="middle" font-size="10" fill="#94a3b8">Task decomposition and dispatch</text>
  <text x="430" y="128" text-anchor="middle" font-size="10" fill="#94a3b8">Parallel group execution via ThreadPool</text>
  <text x="430" y="142" text-anchor="middle" font-size="10" fill="#94a3b8">Timeout handling and error recovery</text>

  <!-- ============ TASK DECOMPOSER (top right) ============ -->
  <g filter="url(#shadowSm)">
    <rect x="600" y="70" width="220" height="80" rx="8" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="1"/>
  </g>
  <text x="710" y="93" text-anchor="middle" font-size="11" fill="#334155" font-weight="600">Task Decomposer</text>
  <text x="710" y="112" text-anchor="middle" font-size="10" fill="#64748b">5 parallel groups</text>
  <text x="710" y="126" text-anchor="middle" font-size="10" fill="#64748b">Per-language generation</text>
  <text x="710" y="140" text-anchor="middle" font-size="10" fill="#64748b">Dependency-aware ordering</text>

  <!-- Arrow from coordinator to decomposer -->
  <line x1="560" y1="110" x2="598" y2="110" stroke="#94a3b8" stroke-width="1.5" marker-end="url(#arrowD)"/>

  <!-- ============ DISPATCH ARROWS (coordinator to specialists) ============ -->
  <!-- Left arrow -->
  <line x1="370" y1="150" x2="185" y2="218" stroke="#94a3b8" stroke-width="1.5" marker-end="url(#arrowD)"/>
  <!-- Center arrow -->
  <line x1="430" y1="150" x2="430" y2="218" stroke="#94a3b8" stroke-width="1.5" marker-end="url(#arrowD)"/>
  <!-- Right arrow -->
  <line x1="490" y1="150" x2="675" y2="218" stroke="#94a3b8" stroke-width="1.5" marker-end="url(#arrowD)"/>

  <text x="280" y="185" font-size="9" fill="#64748b" text-anchor="middle">dispatch</text>
  <text x="445" y="185" font-size="9" fill="#64748b">dispatch</text>
  <text x="580" y="185" font-size="9" fill="#64748b" text-anchor="middle">dispatch</text>

  <!-- ============ SPECIALIST AGENTS (middle row) ============ -->

  <!-- Generator Specialist -->
  <g filter="url(#shadowSm)">
    <rect x="60" y="222" width="250" height="90" rx="8" fill="url(#specBg)"/>
  </g>
  <text x="185" y="245" text-anchor="middle" font-size="12" fill="#fff" font-weight="700">Generator Specialist</text>
  <text x="185" y="264" text-anchor="middle" font-size="10" fill="#e0e7ff">Per-language code generation</text>
  <text x="185" y="280" text-anchor="middle" font-size="10" fill="#e0e7ff">Python / Rust / C / JS / Verilog</text>
  <text x="185" y="296" text-anchor="middle" font-size="10" fill="#c7d2fe">Capabilities: generate, emit, format</text>

  <!-- Verifier Specialist -->
  <g filter="url(#shadowSm)">
    <rect x="340" y="222" width="180" height="90" rx="8" fill="url(#specBg)"/>
  </g>
  <text x="430" y="245" text-anchor="middle" font-size="12" fill="#fff" font-weight="700">Verifier Specialist</text>
  <text x="430" y="264" text-anchor="middle" font-size="10" fill="#e0e7ff">Syntax + semantic checks</text>
  <text x="430" y="280" text-anchor="middle" font-size="10" fill="#e0e7ff">Deep toolchain verification</text>
  <text x="430" y="296" text-anchor="middle" font-size="10" fill="#c7d2fe">Capabilities: verify, lint, test</text>

  <!-- Diagnoser Specialist -->
  <g filter="url(#shadowSm)">
    <rect x="550" y="222" width="260" height="90" rx="8" fill="url(#specBg)"/>
  </g>
  <text x="680" y="245" text-anchor="middle" font-size="12" fill="#fff" font-weight="700">Diagnoser Specialist</text>
  <text x="680" y="264" text-anchor="middle" font-size="10" fill="#e0e7ff">Error pattern matching (KB-first)</text>
  <text x="680" y="280" text-anchor="middle" font-size="10" fill="#e0e7ff">LLM escalation for novel errors</text>
  <text x="680" y="296" text-anchor="middle" font-size="10" fill="#c7d2fe">Capabilities: diagnose, fix, learn</text>

  <!-- ============ RESULT ARROWS (specialists to consensus) ============ -->
  <line x1="185" y1="312" x2="330" y2="372" stroke="#94a3b8" stroke-width="1.5" marker-end="url(#arrowD)"/>
  <line x1="430" y1="312" x2="430" y2="366" stroke="#94a3b8" stroke-width="1.5" marker-end="url(#arrowD)"/>
  <line x1="680" y1="312" x2="530" y2="372" stroke="#94a3b8" stroke-width="1.5" marker-end="url(#arrowD)"/>

  <text x="260" y="345" font-size="9" fill="#64748b" text-anchor="middle">results</text>
  <text x="445" y="340" font-size="9" fill="#64748b">results</text>
  <text x="600" y="345" font-size="9" fill="#64748b" text-anchor="middle">results</text>

  <!-- ============ CONSENSUS RESOLVER (center bottom) ============ -->
  <g filter="url(#shadow)">
    <rect x="290" y="370" width="280" height="70" rx="10" fill="url(#consBg)"/>
  </g>
  <text x="430" y="395" text-anchor="middle" font-size="13" fill="#78350f" font-weight="700">Consensus Resolver</text>
  <text x="430" y="413" text-anchor="middle" font-size="10" fill="#92400e">Majority voting for agreed fields</text>
  <text x="430" y="427" text-anchor="middle" font-size="10" fill="#92400e">Conflict detection and escalation</text>

  <!-- ============ FINAL RESULT ============ -->
  <line x1="430" y1="440" x2="430" y2="468" stroke="#94a3b8" stroke-width="1.5" marker-end="url(#arrowD)"/>

  <g filter="url(#shadowSm)">
    <rect x="310" y="472" width="240" height="50" rx="8" fill="url(#resBg)"/>
  </g>
  <text x="430" y="493" text-anchor="middle" font-size="12" fill="#fff" font-weight="700">Aggregated Result</text>
  <text x="430" y="510" text-anchor="middle" font-size="10" fill="#e0f2fe">Merged output + conflict report + metrics</text>

  <!-- ============ SIDE ANNOTATIONS ============ -->

  <!-- Workers badge (left) -->
  <rect x="60" y="338" width="100" height="30" rx="6" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="1"/>
  <text x="110" y="357" text-anchor="middle" font-size="10" fill="#334155" font-weight="600">Workers: N</text>
  <line x1="160" y1="353" x2="185" y2="312" stroke="#cbd5e1" stroke-width="1" stroke-dasharray="3,2"/>

  <!-- Timeout badge (right) -->
  <rect x="700" y="338" width="120" height="30" rx="6" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="1"/>
  <text x="760" y="357" text-anchor="middle" font-size="10" fill="#334155" font-weight="600">Timeout: 30s</text>
  <line x1="700" y1="353" x2="680" y2="312" stroke="#cbd5e1" stroke-width="1" stroke-dasharray="3,2"/>

</svg>
